<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>YESCDSbook - 5&nbsp; Clinical trials: finding new treatments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/genomics-of-cancer.html" rel="prev">
<link href="../assets/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/clinical-trials-finding-new-treatments.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Clinical trials: finding new treatments</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">YESCDSbook</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-git"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/vjcitn/YESCDSbook/">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://vjcitn.github.io/YESCDSbook/devel/">
            Browse version `devel`
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/preamble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">YESCDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/counting-cancers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Counting cancers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/mapping-cancer-rates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mapping cancer rates</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/genomics-of-cancer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Genomics of cancer</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/clinical-trials-finding-new-treatments.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Clinical trials: finding new treatments</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#clinical-trials-concepts" id="toc-clinical-trials-concepts" class="nav-link active" data-scroll-target="#clinical-trials-concepts"><span class="header-section-number">5.1</span> Clinical trials concepts</a></li>
  <li><a href="#clinical-trials-for-cancer-treatments" id="toc-clinical-trials-for-cancer-treatments" class="nav-link" data-scroll-target="#clinical-trials-for-cancer-treatments"><span class="header-section-number">5.2</span> Clinical trials for cancer treatments</a></li>
  <li>
<a href="#questions-to-answer-in-designing-a-clinical-trial-article" id="toc-questions-to-answer-in-designing-a-clinical-trial-article" class="nav-link" data-scroll-target="#questions-to-answer-in-designing-a-clinical-trial-article"><span class="header-section-number">6</span> Questions to answer in designing a clinical trial (Article)</a>
  <ul class="collapse">
<li><a href="#the-typical-strategy-three-phases" id="toc-the-typical-strategy-three-phases" class="nav-link" data-scroll-target="#the-typical-strategy-three-phases"><span class="header-section-number">6.1</span> The typical strategy: Three phases</a></li>
  <li><a href="#experimentation-with-human-subjects-is-carefully-regulated" id="toc-experimentation-with-human-subjects-is-carefully-regulated" class="nav-link" data-scroll-target="#experimentation-with-human-subjects-is-carefully-regulated"><span class="header-section-number">6.2</span> Experimentation with human subjects is carefully regulated</a></li>
  <li><a href="#equipoise-when-medical-knowledge-can-only-advance-by-experimenting" id="toc-equipoise-when-medical-knowledge-can-only-advance-by-experimenting" class="nav-link" data-scroll-target="#equipoise-when-medical-knowledge-can-only-advance-by-experimenting"><span class="header-section-number">6.3</span> Equipoise: when medical knowledge can only advance by experimenting</a></li>
  <li><a href="#equipoise-individual-and-clinical" id="toc-equipoise-individual-and-clinical" class="nav-link" data-scroll-target="#equipoise-individual-and-clinical"><span class="header-section-number">6.4</span> Equipoise: individual and clinical</a></li>
  </ul>
</li>
  <li>
<a href="#blinding-and-randomization-to-reduce-bias" id="toc-blinding-and-randomization-to-reduce-bias" class="nav-link" data-scroll-target="#blinding-and-randomization-to-reduce-bias"><span class="header-section-number">7</span> Blinding and randomization to reduce bias</a>
  <ul class="collapse">
<li><a href="#randomization-to-reduce-bias" id="toc-randomization-to-reduce-bias" class="nav-link" data-scroll-target="#randomization-to-reduce-bias"><span class="header-section-number">7.1</span> Randomization to reduce bias</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Clinical trials: finding new treatments</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="clinical-trials-concepts" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="clinical-trials-concepts">
<span class="header-section-number">5.1</span> Clinical trials concepts</h2>
</section><section id="clinical-trials-for-cancer-treatments" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="clinical-trials-for-cancer-treatments">
<span class="header-section-number">5.2</span> Clinical trials for cancer treatments</h2>
<ul>
<li><p>Despite massive investments in cancer research and treatment development, cancer remains a leading cause of death</p></li>
<li>
<p>We have examined many aspects of cancer’s diversity</p>
<ul>
<li>tissue of origin</li>
<li>somatic mutations</li>
<li>response to treatment</li>
</ul>
</li>
<li>
<p>The main modalities of medical response to cancer are</p>
<ul>
<li>surgery</li>
<li>chemotherapy</li>
<li>radiation</li>
</ul>
</li>
<li><p>Each of these modalities has a collection of subtypes, and they are often used in combination</p></li>
<li>
<p>How do doctors and patients navigate the available options?</p>
<ul>
<li>Answer: interpret available data as evidence in favor of or against certain options</li>
</ul>
</li>
<li>
<p>The “gold standard” for evidence in medical decisionmaking is the randomized clinical trial (RCT)</p>
<ul>
<li>Trials are generally preceded by “pre-clinical” studies of drugs or other treatment techniques</li>
<li>Analysis of data in pre-clinical research often demands great versatility of the statisticians and data scientists
<ul>
<li>such data are often sparse and noisy</li>
<li>ideally one integrates all available scientific information about the proposed alternative, requiring extensive literature search and acquisition of public data</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="questions-to-answer-in-designing-a-clinical-trial-article" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Questions to answer in designing a clinical trial <a href="https://www.cancer.org/treatment/treatments-and-side-effects/clinical-trials/what-you-need-to-know/phases-of-clinical-trials.html">(Article)</a>
</h1>
<p>D.1.1 What is the current standard of care?</p>
<p>D.1.2 What care outcomes do we want to improve, and how much improvement would count as a real advance? (Here risk-benefit comparison becomes important)</p>
<p>D.1.3 What is the proposed alternative?</p>
<p>D.1.4 How do we determine a safe “dose” of the proposed alternative? (In the case of surgery this question may not make sense)</p>
<p>D.1.5 How do we verify that the proposed alternative has any effect at all?</p>
<p>D.1.6 How do we measure the overall benefit conferred by using the alternative method?</p>
<section id="the-typical-strategy-three-phases" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="the-typical-strategy-three-phases">
<span class="header-section-number">6.1</span> The typical strategy: Three phases</h2>
<ul>
<li>Phase I: enroll healthy volunteers to do dose finding, assessing toxicity and side effects</li>
<li>Phase II: enroll patients with the disease and administer the maximum tolerated dose to establish that the new treatment has some beneficial effect</li>
<li>Phase III: enroll patients with the disease, but set up a comparison of the new treatment versus the standard of care
<ul>
<li>a design plan is produced detailing how many patients are to be enrolled, how the treatments will be administered, and how the data will be analyzed</li>
<li>patients are randomly assigned either the new treatment, or the standard of care</li>
<li>a Data Safety Monitoring Board will review study data periodically
<ul>
<li>studies may end prematurely if great benefit is seen early on, or if it appears no benefit could be documented by continuing the trial</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="experimentation-with-human-subjects-is-carefully-regulated" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="experimentation-with-human-subjects-is-carefully-regulated">
<span class="header-section-number">6.2</span> Experimentation with human subjects is carefully regulated</h2>
<p>The concept of <a href="https://www.cancer.org/treatment/treatments-and-side-effects/clinical-trials/what-you-need-to-know/what-does-a-clinical-trial-involve.html">informed consent</a> is central in the implementation of clinical trials.</p>
<p>The <a href="https://www.hhs.gov/ohrp/regulations-and-policy/belmont-report/index.html">Belmont report</a> defined principles and guidelines for all human subjects research.</p>
</section><section id="equipoise-when-medical-knowledge-can-only-advance-by-experimenting" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="equipoise-when-medical-knowledge-can-only-advance-by-experimenting">
<span class="header-section-number">6.3</span> Equipoise: when medical knowledge can only advance by experimenting</h2>
</section><section id="equipoise-individual-and-clinical" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="equipoise-individual-and-clinical">
<span class="header-section-number">6.4</span> Equipoise: individual and clinical</h2>
<p>Distinguished in <a href="https://journalofethics.ama-assn.org/article/question-clinical-equipoise-and-patients-best-interests/2015-12">AMA ethics, 2015</a></p>
<blockquote class="blockquote">
<p>What is the state of medical knowledge? Why is this trial asking an important question? How does the likelihood of benefiting in study A compare with that of benefiting in study B or with the standard of care? – attributed to B. Freedman</p>
</blockquote>
<ul>
<li><p>Belief in the new treatment</p></li>
<li><p>Belief in the patient’s suitability for the new treatment</p></li>
<li><p>Interpretation of new evidence</p></li>
<li><p>Risk that new evidence will “regress”</p></li>
<li><p>Alternative: fully informed patient consent</p></li>
</ul></section></section><section id="blinding-and-randomization-to-reduce-bias" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Blinding and randomization to reduce bias</h1>
<p>The concept of the double-blind clinical experiment is well-established</p>
<ul>
<li><p>The investigator does not know what treatment has been given to the patient</p></li>
<li><p>The patient does not know what drug they have received</p></li>
</ul>
<p>This is accomplished by providing treatments that are identical in appearance, taste, etc., but differ in their chemical composition and hypothesized effects. An independent party has knowledge of the treatment that has been administered, and can decode the treatment assignments as needed.</p>
<p>The role of blinding in experimentation is reviewed in a <a href="https://www.nature.com/articles/526187a">Nature commentary</a>, and the <a href="https://en.wikipedia.org/wiki/Blinded_experiment">Wikipedia article</a> has many useful references.</p>
<section id="randomization-to-reduce-bias" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="randomization-to-reduce-bias">
<span class="header-section-number">7.1</span> Randomization to reduce bias</h2>
<p>Once blinding has been accomplished it may seem unnecessary to take further steps to eliminate bias in the evaluation of an experimental comparison.</p>
<p>Blinding helps to eliminate specific forms of bias rooted in (possibly un- or sub-conscious) investigator or participant actions that may affect experimental outcomes or interpretation.</p>
<p>Other forms of bias can be mitigated using random allocation of treatments to participants. As an illustration suppose an investigator decides to use “alternating assignments”, and typically sees two eligible patients a day. We could then have</p>
<pre><code>                Day 1    Day 2   Day 3 ....
Treatment      A    B    A   B   A   B
Time of day    AM   PM   AM  PM  AM  PM</code></pre>
<p>A problem would arise if the characteristics of patients coming in the morning were different from those coming in the afternoon. For example, the patients arriving in the AM slot could tend to be older. The comparison between treatments A and B would then be confounded with a difference in average ages of patients in the experiment.</p>
<p>If, instead of alternation, the treatment assignment were randomized, the patients receiving treatment A would have characteristics that are <em>on average</em> indistinguishable from those receiving treatment B.</p>
<p>Details of the approach to randomization will have an impact on its effectivness. Challenges can arise in multicenter studies with many centers. The following display plots the excess numbers of patients assigned to one arm in a trial, against the total number enrolled.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://github.com/vjcitn/YESCDS/blob/main/man/figures/loose.jpg?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Excursions 1</figcaption></figure>
</div>
<p>There are long stretches of time during which more patients in the study are receiving one of the treatments than the other.</p>
<p>The use of a different approach to randomization, in which small blocks of allocations are randomized independently, can reduce the size and duration of periods of imbalance over time.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://github.com/vjcitn/YESCDS/blob/main/man/figures/tight.jpg?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Excursions 2</figcaption></figure>
</div>
<p>Randomization is a well-accepted tool in experimental design, but must be conducted with care. The <a href="https://en.wikipedia.org/wiki/Randomized_experiment">wikipedia article</a> has some interesting references on assessment of the overall effect of use of randomization in health research.</p>


</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../pages/genomics-of-cancer.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Genomics of cancer</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">This book was built with <a href="https://github.com/js2264/BiocBook/">BiocBook</a> with <span class="emoji" data-emoji="heart">❤️</span></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>